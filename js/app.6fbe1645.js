(function(e){function t(t){for(var n,s,o=t[0],c=t[1],u=t[2],d=0,f=[];d<o.length;d++)s=o[d],a[s]&&f.push(a[s][0]),a[s]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);l&&l(t);while(f.length)f.shift()();return i.push.apply(i,u||[]),r()}function r(){for(var e,t=0;t<i.length;t++){for(var r=i[t],n=!0,o=1;o<r.length;o++){var c=r[o];0!==a[c]&&(n=!1)}n&&(i.splice(t--,1),e=s(s.s=r[0]))}return e}var n={},a={app:0},i=[];function s(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,s),r.l=!0,r.exports}s.m=e,s.c=n,s.d=function(e,t,r){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(s.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(r,n,function(t){return e[t]}.bind(null,n));return r},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],c=o.push.bind(o);o.push=t,o=o.slice();for(var u=0;u<o.length;u++)t(o[u]);var l=c;i.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"14d3":function(e,t,r){"use strict";var n=r("2d27"),a=r.n(n);a.a},"2d27":function(e,t,r){},"56d7":function(e,t,r){"use strict";r.r(t);r("cadf"),r("551c"),r("f751"),r("097d");var n=r("2b0e"),a=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"my-24",attrs:{id:"app"}},[r("div",{staticClass:"max-w-lg mx-auto w-full"},[e.sections.length?[e._l(e.sections,function(t,n){return[r("re-section",{key:t.id,staticClass:"my-3",attrs:{i:n,l:e.sections.length,data:t,moveUp:e.moveUp,moveDn:e.moveDn},on:{refresh:e.refreshSections,remove:function(r){return e.removeSection(t)}}})]})]:e._e(),r("button",{staticClass:"mx-auto mt-16 h-16 w-16 bg-white rounded-full flex items-center justify-center shadow",on:{click:e.createSection}},[r("span",{staticClass:"text-3x1"},[e._v("+")])])],2)])},i=[],s=(r("ac6a"),r("f499")),o=r.n(s),c=r("cebc"),u=(r("96cf"),r("3b8d")),l=r("c64e"),d=r.n(l),f=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"w-full flex border border-grey rounded"},[r("div",{staticClass:"w-16 flex border-r border-grey items-center justify-center"},[e.data?[e.i>0?r("button",{staticClass:"block",on:{click:function(t){return e.moveUp(e.data.id,e.i)}}},[e._v("↑")]):e._e(),e.i<e.l-1?r("button",{staticClass:"block",on:{click:function(t){return e.moveDn(e.data.id,e.i)}}},[e._v("↓")]):e._e()]:e._e()],2),r("div",{staticClass:"w-2/5 border-r border-grey relative"},[r("textarea",{directives:[{name:"model",rawName:"v-model",value:e.section.meta,expression:"section.meta"}],staticClass:"w-full h-full bg-grey-lightest resize-none outline-none p-2",attrs:{placholder:"Placeholder"},domProps:{value:e.section.meta},on:{input:[function(t){t.target.composing||e.$set(e.section,"meta",t.target.value)},e.saveSection]}})]),r("div",{staticClass:"w-2/5"},[e.section.tracks&&e.section.tracks.length?[e._l(e.section.tracks,function(t){return[r("div",{staticClass:"flex p-1 m-1 bg-grey-lightest"},[r("re-track",{key:t.id,attrs:{data:t}}),r("button",{staticClass:"mx-2 opacity-50",on:{click:function(r){return e.removeTrack(t.id)}}},[e._v("x")])],1)]})]:e._e()],2),r("div",{staticClass:"w-24 border-l border-grey relative flex items-center justify-center"},[r("div",{staticClass:"flex"},[e.data?[r("button",{staticClass:"w-8 h-8 rounded-full flex items-center justify-center",on:{click:function(t){return e.$emit("remove")}}},[r("span",{staticClass:"opacity-50"},[e._v("x")])])]:e._e(),r("re-recorder",{staticClass:"ml-2",on:{newTrack:e.addTrack}})],2)])])},p=[],h=(r("c5f6"),function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"w-full"},[e.data?[r("div",{staticClass:"w-full flex relative rounded overflow-hidden px-2"},[r("div",{staticClass:"progress absolute pin bg-red z-0 opacity-25",style:{width:e.progress+"%"}}),r("div",{staticClass:"z-10 flex w-full items-center"},[r("audio",{ref:e.data.id,attrs:{src:e.src}}),r("div",{staticClass:"w-6 flex items-center justify-center"},[e.playing?e._e():r("button",{staticClass:"pb-1",on:{click:e.play}},[e._v("▷")]),e.playing?r("button",{staticClass:"pb-1",on:{click:e.pause}},[e._v("▯▯")]):e._e()]),r("div",{staticClass:"flex-auto"}),r("span",[e._v(e._s(e.timestamp))])])])]:e._e()],2)}),m=[],v=(r("28a5"),r("32d2")),g=r.n(v);r("34ef");function w(e,t,r){t=t||"",r=r||512;for(var n=atob(e),a=[],i=0;i<n.length;i+=r){for(var s=n.slice(i,i+r),o=new Array(s.length),c=0;c<s.length;c++)o[c]=s.charCodeAt(c);var u=new Uint8Array(o);a.push(u)}var l=new Blob(a,{type:t});return l}var b=r("795b"),S=r.n(b);function y(e){return x.apply(this,arguments)}function x(){return x=Object(u["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",new S.a(function(e){return setTimeout(e,t)}));case 1:case"end":return e.stop()}},e,this)})),x.apply(this,arguments)}function k(e){var t=e<0?"-":"",r=Math.floor(Math.abs(e)),n=Math.floor(60*Math.abs(e)%60);return t+(r<10?"0":"")+r+":"+(n<10?"0":"")+n}var R={props:{data:Object},data:function(){return{src:null,duration:null,timestamp:null,playing:!1,progress:0}},mounted:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.data.src.split(",").slice(1).join(),r="audio/webm;codecs=opus",n=w(t,r),e.next=5,g()(n);case 5:this.duration=e.sent,this.timestamp=k(this.duration/60),this.src=URL.createObjectURL(n);case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{play:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t,r){var n,a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.playing=!0,n=this.$refs[this.data.id],n.play(),a=1e3*(this.duration-n.currentTime),n.addEventListener("timeupdate",this.handleProgress),e.next=7,y(a);case 7:this.stop();case 8:case"end":return e.stop()}},e,this)}));function t(t,r){return e.apply(this,arguments)}return t}(),handleProgress:function(e){e.timeStamp;var t=this.$refs[this.data.id];this.progress=Math.round(t.currentTime/this.duration*100)},pause:function(e,t){this.playing=!1;var r=this.$refs[this.data.id];r.pause()},stop:function(){var e=this.$refs[this.data.id];e.removeEventListener("timeupdate",this.handleProgress),this.progress>90&&(this.progress=100),this.playing&&(this.pause(),this.$refs[this.data.id].currentTime=0)}}},O=R,j=r("2877"),_=Object(j["a"])(O,h,m,!1,null,null,null),C=_.exports,T=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"flex"},[e.recording?e._e():r("button",{staticClass:"outline-none bg-red-dark text-white rounded-full w-8 h-8",on:{click:e.startRecord}},[e._v("·")]),e.recording?r("button",{staticClass:"outline-none bg-red animate-recording text-white rounded-full w-8 h-8",on:{click:e.stopRecord}},[e._v("·")]):e._e()])},$=[],I={components:{},data:function(){return{stream:null,mediaRecorder:null,chunks:[],recording:!1}},mounted:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.next=2,navigator.mediaDevices.getUserMedia({audio:!0});case 2:this.stream=e.sent,this.mediaRecorder=new MediaRecorder(this.stream),this.mediaRecorder.ondataavailable=function(e){var r=e.data;t.chunks.push(r)},this.mediaRecorder.onstop=function(){var e=new Blob(t.chunks,{type:"audio/webm;codecs=opus"});t.chunks=[];var r="re-trk-".concat(d()()),n=new FileReader;n.onload=function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(n){var a;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return a=n.target.result,localStorage.setItem(r,a),e.next=4,y(500);case 4:t.$emit("newTrack",r);case 5:case"end":return e.stop()}},e,this)}));return function(t){return e.apply(this,arguments)}}(),n.readAsDataURL(e)};case 6:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{startRecord:function(){this.mediaRecorder.start(),this.recording=!0},stopRecord:function(){this.mediaRecorder.stop(),this.recording=!1}}},N=I,J=(r("14d3"),Object(j["a"])(N,T,$,!1,null,"28c43ad2",null)),M=J.exports,P={meta:null,tracks:[],createdAt:null,updatedAt:null},A={props:{data:Object,i:Number,l:Number,moveUp:Function,moveDn:Function},components:{ReTrack:C,ReRecorder:M},data:function(){return{section:{}}},computed:{localSection:function(){return this.data?JSON.parse(localStorage[this.data.id]):null}},watch:{data:function(){this.initSection()}},mounted:function(){this.initSection()},methods:{initSection:function(){if(this.data)this.section=this.data;else{var e,t;e=t=new Date;var r=Object(c["a"])({},P,{createdAt:e,updatedAt:t});this.section=r}},addToSections:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){var r;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return r=JSON.parse(localStorage.getItem("re-sections")||"  []"),r.push(t),localStorage.setItem("re-sections",o()(r)),e.next=5,this.refreshSections();case 5:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),refreshSections:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.initSection(),e.next=3,y(1500);case 3:this.$emit("refresh");case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),createSection:function(){var e="re-sct-".concat(d()());localStorage.setItem(e,o()(Object(c["a"])({},this.section,{id:e}))),this.addToSections(e)},saveSection:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t=this.localSection,t?localStorage.setItem(t.id,o()(Object(c["a"])({},t,{meta:this.section.meta}))):this.createSection(),e.next=4,this.refreshSections();case 4:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),addTrack:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.localSection.tracks=this.localSection.tracks.concat(t),e.next=3,this.saveSection();case 3:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}(),removeTrack:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(t){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return this.localSection.tracks=this.localSection.tracks.filter(function(e){return e!==t}),e.next=3,this.saveSection();case 3:case"end":return e.stop()}},e,this)}));function t(t){return e.apply(this,arguments)}return t}()}},D=A,U=Object(j["a"])(D,f,p,!1,null,"4d852438",null),E=U.exports,L={components:{ReSection:E},data:function(){return{sections:[]}},mounted:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:this.$nextTick(Object(u["a"])(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return e.abrupt("return",t.refreshSections());case 1:case"end":return e.stop()}},e,this)})));case 1:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),methods:{refreshSections:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:t=JSON.parse(localStorage["re-sections"]||"[]"),this.sections=t.map(function(e){var t=JSON.parse(localStorage[e]),r=t.tracks?t.tracks.map(function(e){return{id:e,src:localStorage[e]}}):[];return Object(c["a"])({id:e},t,{tracks:r})});case 2:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),createSection:function(){var e=Object(u["a"])(regeneratorRuntime.mark(function e(){var t,r,n;return regeneratorRuntime.wrap(function(e){while(1)switch(e.prev=e.next){case 0:return t="re-sct-".concat(d()()),r={id:t,meta:null,tracks:[],createdAt:new Date,updatedAt:new Date},localStorage.setItem(t,o()(r)),n=JSON.parse(localStorage.getItem("re-sections")||"  []"),n.push(t),localStorage.setItem("re-sections",o()(n)),e.next=8,this.refreshSections();case 8:case"end":return e.stop()}},e,this)}));function t(){return e.apply(this,arguments)}return t}(),removeSection:function(e){var t=this,r=JSON.parse(localStorage["re-sections"]||"[]"),n=JSON.parse(localStorage[e.id]),a=n.tracks;a&&a.length&&a.forEach(function(e){localStorage.removeItem(e)}),localStorage.removeItem(e.id),localStorage.setItem("re-sections",o()(r.filter(function(t){return t!==e.id}))),setTimeout(function(){return t.refreshSections()},1500)},moveUp:function(e,t){var r=JSON.parse(localStorage["re-sections"]||"[]");r[t]=r[t-1],r[t-1]=e,localStorage.setItem("re-sections",o()(r)),this.refreshSections()},moveDn:function(e,t){var r=JSON.parse(localStorage["re-sections"]||"[]");r[t]=r[t+1],r[t+1]=e,localStorage.setItem("re-sections",o()(r)),this.refreshSections()}}},z=L,F=Object(j["a"])(z,a,i,!1,null,null,null),B=F.exports;r("fe46");n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(B)}}).$mount("#app")},fe46:function(e,t,r){}});
//# sourceMappingURL=app.6fbe1645.js.map